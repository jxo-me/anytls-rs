# è´¡çŒ®æŒ‡å—

æ„Ÿè°¢æ‚¨å¯¹ AnyTLS-RS é¡¹ç›®çš„å…´è¶£ï¼æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å½¢å¼çš„è´¡çŒ®ã€‚

---

## ğŸ“‹ ç›®å½•

1. [è¡Œä¸ºå‡†åˆ™](#è¡Œä¸ºå‡†åˆ™)
2. [å¦‚ä½•è´¡çŒ®](#å¦‚ä½•è´¡çŒ®)
3. [å¼€å‘ç¯å¢ƒè®¾ç½®](#å¼€å‘ç¯å¢ƒè®¾ç½®)
4. [å¼€å‘æµç¨‹](#å¼€å‘æµç¨‹)
5. [ä»£ç è§„èŒƒ](#ä»£ç è§„èŒƒ)
6. [æµ‹è¯•è¦æ±‚](#æµ‹è¯•è¦æ±‚)
7. [æ–‡æ¡£è¦æ±‚](#æ–‡æ¡£è¦æ±‚)
8. [æäº¤è§„èŒƒ](#æäº¤è§„èŒƒ)
9. [Pull Request æµç¨‹](#pull-request-æµç¨‹)

---

## è¡Œä¸ºå‡†åˆ™

### æˆ‘ä»¬çš„æ‰¿è¯º

ä¸ºäº†è¥é€ å¼€æ”¾å’Œå‹å¥½çš„ç¯å¢ƒï¼Œæˆ‘ä»¬æ‰¿è¯ºï¼š

- å°Šé‡æ‰€æœ‰è´¡çŒ®è€…
- æ¥å—å»ºè®¾æ€§çš„æ‰¹è¯„
- å…³æ³¨ç¤¾åŒºæœ€å¤§åˆ©ç›Š
- å¯¹ä»–äººå±•ç°åŒç†å¿ƒ

### ä¸å¯æ¥å—çš„è¡Œä¸º

- ä½¿ç”¨æ€§åˆ«åŒ–è¯­è¨€æˆ–å›¾åƒ
- äººèº«æ”»å‡»æˆ–ä¾®è¾±
- å…¬å¼€æˆ–ç§ä¸‹éªšæ‰°
- æœªç»æˆæƒå‘å¸ƒä»–äººéšç§ä¿¡æ¯
- å…¶ä»–ä¸å½“è¡Œä¸º

---

## å¦‚ä½•è´¡çŒ®

### æŠ¥å‘Š Bug

å¦‚æœæ‚¨å‘ç° bugï¼Œè¯·ï¼š

1. åœ¨ [GitHub Issues](https://github.com/yourusername/anytls-rs/issues) æœç´¢æ˜¯å¦å·²å­˜åœ¨
2. å¦‚æœä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°çš„ issue
3. ä½¿ç”¨æ¸…æ™°çš„æ ‡é¢˜
4. æä¾›è¯¦ç»†çš„å¤ç°æ­¥éª¤
5. åŒ…å«ç³»ç»Ÿä¿¡æ¯ï¼ˆOSã€Rust ç‰ˆæœ¬ç­‰ï¼‰
6. é™„ä¸Šæ—¥å¿—æˆ–é”™è¯¯ä¿¡æ¯

**Bug æŠ¥å‘Šæ¨¡æ¿**:

```markdown
**æè¿°**
ç®€è¦æè¿° bug

**å¤ç°æ­¥éª¤**
1. æ‰§è¡Œå‘½ä»¤ '...'
2. è¿æ¥åˆ° '...'
3. çœ‹åˆ°é”™è¯¯ '...'

**é¢„æœŸè¡Œä¸º**
åº”è¯¥å‘ç”Ÿä»€ä¹ˆ

**å®é™…è¡Œä¸º**
å®é™…å‘ç”Ÿäº†ä»€ä¹ˆ

**ç¯å¢ƒ**
- OS: [e.g., Windows 10, Ubuntu 22.04]
- Rust ç‰ˆæœ¬: [e.g., 1.70.0]
- AnyTLS-RS ç‰ˆæœ¬: [e.g., 0.2.0]

**æ—¥å¿—**
```
ç²˜è´´ç›¸å…³æ—¥å¿—
```

**é¢å¤–ä¿¡æ¯**
å…¶ä»–æœ‰ç”¨çš„ä¿¡æ¯
```

### æå‡ºåŠŸèƒ½è¯·æ±‚

1. æœç´¢ç°æœ‰çš„ feature requests
2. åˆ›å»ºæ–°çš„ issueï¼Œæ ‡è®°ä¸º "enhancement"
3. æ¸…æ™°æè¿°å»ºè®®çš„åŠŸèƒ½
4. è§£é‡Šä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªåŠŸèƒ½
5. æä¾›ä½¿ç”¨ç¤ºä¾‹ï¼ˆå¦‚æœå¯èƒ½ï¼‰

### è´¡çŒ®ä»£ç 

æˆ‘ä»¬æ¬¢è¿ Pull Requestsï¼è¯·å‚è€ƒä¸‹é¢çš„å¼€å‘æµç¨‹ã€‚

### æ”¹è¿›æ–‡æ¡£

- ä¿®æ­£æ‹¼å†™é”™è¯¯
- æ”¹è¿›è¯´æ˜æ¸…æ™°åº¦
- æ·»åŠ ç¤ºä¾‹
- ç¿»è¯‘æ–‡æ¡£

---

## å¼€å‘ç¯å¢ƒè®¾ç½®

### å‰ç½®è¦æ±‚

- **Rust** 1.70 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Git**
- **ç¼–è¾‘å™¨**ï¼ˆæ¨è VS Code + rust-analyzerï¼‰

### å…‹éš†ä»“åº“

```bash
git clone https://github.com/yourusername/anytls-rs.git
cd anytls-rs
```

### å®‰è£…ä¾èµ–

```bash
# Rust å·¥å…·é“¾
rustup update stable

# æ ¼å¼åŒ–å·¥å…·
rustup component add rustfmt

# Linter
rustup component add clippy
```

### æ„å»ºé¡¹ç›®

```bash
# å¼€å‘æ„å»º
cargo build

# å‘å¸ƒæ„å»º
cargo build --release
```

### è¿è¡Œæµ‹è¯•

```bash
# æ‰€æœ‰æµ‹è¯•
cargo test

# å•å…ƒæµ‹è¯•
cargo test --lib

# é›†æˆæµ‹è¯•
cargo test --test '*'

# å®Œæ•´è‡ªåŠ¨åŒ–æµ‹è¯•
powershell -ExecutionPolicy Bypass -File .\run_comprehensive_tests.ps1
```

---

## å¼€å‘æµç¨‹

### 1. Fork ä»“åº“

ç‚¹å‡» GitHub é¡µé¢å³ä¸Šè§’çš„ "Fork" æŒ‰é’®ã€‚

### 2. åˆ›å»ºåˆ†æ”¯

```bash
# åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/your-feature-name

# æˆ–è€… bug ä¿®å¤åˆ†æ”¯
git checkout -b fix/bug-description
```

**åˆ†æ”¯å‘½åè§„èŒƒ**:

- `feature/` - æ–°åŠŸèƒ½
- `fix/` - Bug ä¿®å¤
- `docs/` - æ–‡æ¡£æ›´æ–°
- `refactor/` - ä»£ç é‡æ„
- `test/` - æµ‹è¯•ç›¸å…³
- `chore/` - æ‚é¡¹æ›´æ”¹

### 3. è¿›è¡Œæ›´æ”¹

- éµå¾ªä»£ç è§„èŒƒï¼ˆè§ä¸‹æ–‡ï¼‰
- ç¼–å†™æµ‹è¯•
- æ›´æ–°æ–‡æ¡£
- é¢‘ç¹æäº¤

### 4. è¿è¡Œæ£€æŸ¥

```bash
# æ ¼å¼åŒ–
cargo fmt

# Clippy æ£€æŸ¥
cargo clippy --all-targets -- -D warnings

# è¿è¡Œæµ‹è¯•
cargo test
```

### 5. æäº¤æ›´æ”¹

```bash
git add .
git commit -m "feat: add amazing feature"
```

éµå¾ª[æäº¤è§„èŒƒ](#æäº¤è§„èŒƒ)ã€‚

### 6. æ¨é€åˆ° Fork

```bash
git push origin feature/your-feature-name
```

### 7. åˆ›å»º Pull Request

åœ¨ GitHub ä¸Šåˆ›å»º Pull Requestï¼Œéµå¾ª [PR æµç¨‹](#pull-request-æµç¨‹)ã€‚

---

## ä»£ç è§„èŒƒ

### Rust é£æ ¼æŒ‡å—

éµå¾ª [Rust å®˜æ–¹é£æ ¼æŒ‡å—](https://doc.rust-lang.org/nightly/style-guide/)ã€‚

### å…³é”®è§„åˆ™

#### 1. æ ¼å¼åŒ–

```bash
# è‡ªåŠ¨æ ¼å¼åŒ–
cargo fmt
```

#### 2. Naming

```rust
// ç±»å‹ä½¿ç”¨ PascalCase
struct MyStruct;
enum MyEnum;

// å‡½æ•°å’Œå˜é‡ä½¿ç”¨ snake_case
fn my_function() {}
let my_variable = 10;

// å¸¸é‡ä½¿ç”¨ SCREAMING_SNAKE_CASE
const MAX_CONNECTIONS: usize = 100;
```

#### 3. æ³¨é‡Š

```rust
/// å‡½æ•°çš„æ–‡æ¡£æ³¨é‡Š
///
/// # Examples
///
/// ```
/// let result = my_function(42);
/// assert_eq!(result, 84);
/// ```
pub fn my_function(value: i32) -> i32 {
    value * 2
}

// å†…è”æ³¨é‡Šè§£é‡Šå¤æ‚é€»è¾‘
let result = complex_calculation(); // è®¡ç®—ç»“æœ
```

#### 4. é”™è¯¯å¤„ç†

```rust
// ä½¿ç”¨ Result è€Œä¸æ˜¯ panic
pub fn risky_operation() -> Result<String, AnyTlsError> {
    if condition {
        Ok("success".to_string())
    } else {
        Err(AnyTlsError::SomeError)
    }
}

// ä½¿ç”¨ ? æ“ä½œç¬¦
let value = risky_operation()?;
```

#### 5. å¼‚æ­¥ä»£ç 

```rust
// å¼‚æ­¥å‡½æ•°æ¸…æ™°æ ‡æ³¨
pub async fn async_operation() -> Result<()> {
    // ä½¿ç”¨ .await
    let result = future.await?;
    Ok(())
}
```

### Clippy

ç¡®ä¿æ²¡æœ‰ Clippy è­¦å‘Šï¼š

```bash
cargo clippy --all-targets -- -D warnings
```

å¸¸è§ Clippy ä¿®å¤ï¼š

```rust
// é¿å…ä¸å¿…è¦çš„ clone
âŒ let s = string.clone();
âœ… let s = string; // å¦‚æœä¸å†ä½¿ç”¨ string

// ä½¿ç”¨ if let
âŒ match option {
    Some(x) => do_something(x),
    None => {}
}
âœ… if let Some(x) = option {
    do_something(x);
}

// é¿å…ä¸å¿…è¦çš„ unwrap
âŒ let value = option.unwrap();
âœ… let value = option.expect("should have value");
```

---

## æµ‹è¯•è¦æ±‚

### æµ‹è¯•ç±»å‹

#### 1. å•å…ƒæµ‹è¯•

```rust
#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_basic_functionality() {
        let result = my_function(42);
        assert_eq!(result, 84);
    }

    #[tokio::test]
    async fn test_async_functionality() {
        let result = async_function().await.unwrap();
        assert_eq!(result, "expected");
    }
}
```

#### 2. é›†æˆæµ‹è¯•

åœ¨ `tests/` ç›®å½•ä¸‹ï¼š

```rust
// tests/my_integration_test.rs
use anytls_rs::*;

#[tokio::test]
async fn test_end_to_end() {
    // æµ‹è¯•å®Œæ•´æµç¨‹
}
```

#### 3. æ–‡æ¡£æµ‹è¯•

```rust
/// è®¡ç®—ä¸¤ä¸ªæ•°çš„å’Œ
///
/// # Examples
///
/// ```
/// use anytls_rs::add;
/// assert_eq!(add(2, 2), 4);
/// ```
pub fn add(a: i32, b: i32) -> i32 {
    a + b
}
```

### æµ‹è¯•è¦†ç›–è¦æ±‚

- **æ–°åŠŸèƒ½**: å¿…é¡»æœ‰æµ‹è¯•
- **Bug ä¿®å¤**: å¿…é¡»æœ‰å›å½’æµ‹è¯•
- **æ ¸å¿ƒæ¨¡å—**: è¦†ç›–ç‡ > 80%

### è¿è¡Œæµ‹è¯•

```bash
# æ‰€æœ‰æµ‹è¯•
cargo test

# ç‰¹å®šæ¨¡å—
cargo test session::

# æ˜¾ç¤ºè¾“å‡º
cargo test -- --nocapture

# å•çº¿ç¨‹è¿è¡Œ
cargo test -- --test-threads=1
```

---

## æ–‡æ¡£è¦æ±‚

### ä»£ç æ–‡æ¡£

#### Public API

æ‰€æœ‰ public å‡½æ•°ã€ç»“æ„ã€trait å¿…é¡»æœ‰æ–‡æ¡£ï¼š

```rust
/// Session ç®¡ç†å¤šä¸ª Stream çš„å¤ç”¨è¿æ¥
///
/// Session ä½¿ç”¨å•ä¸ª TLS è¿æ¥æ‰¿è½½å¤šä¸ªé€»è¾‘ Streamï¼Œ
/// å®ç°äº†é«˜æ•ˆçš„è¿æ¥å¤ç”¨ã€‚
///
/// # Examples
///
/// ```no_run
/// use anytls_rs::Session;
///
/// # async fn example() -> Result<(), Box<dyn std::error::Error>> {
/// let session = Session::new(reader, writer, true);
/// let stream = session.open_stream().await?;
/// # Ok(())
/// # }
/// ```
pub struct Session {
    // ...
}
```

#### Private å‡½æ•°

å¤æ‚çš„ private å‡½æ•°ä¹Ÿåº”æœ‰æ³¨é‡Šï¼š

```rust
// å¤„ç†æ¥æ”¶åˆ°çš„ Frame å¹¶åˆ†å‘åˆ°å¯¹åº” Stream
//
// æ ¹æ® Frame çš„ command ç±»å‹å’Œ stream_idï¼Œ
// å°†æ•°æ®å‘é€åˆ°å¯¹åº”çš„ Stream æˆ–æ‰§è¡Œæ§åˆ¶æ“ä½œã€‚
fn handle_frame(&self, frame: Frame) -> Result<()> {
    // ...
}
```

### Markdown æ–‡æ¡£

#### æ›´æ–°ç°æœ‰æ–‡æ¡£

- ä¿æŒä¸€è‡´æ€§
- æ›´æ–°ç¤ºä¾‹
- ä¿®æ­£è¿‡æ—¶ä¿¡æ¯

#### åˆ›å»ºæ–°æ–‡æ¡£

- æ¸…æ™°çš„æ ‡é¢˜
- ç›®å½•ï¼ˆå¦‚æœå†…å®¹è¾ƒé•¿ï¼‰
- ä»£ç ç¤ºä¾‹
- æˆªå›¾ï¼ˆå¦‚æœæœ‰å¸®åŠ©ï¼‰

### æ–‡æ¡£æµ‹è¯•

```bash
# æµ‹è¯•æ–‡æ¡£ä¸­çš„ç¤ºä¾‹
cargo test --doc
```

---

## æäº¤è§„èŒƒ

### Conventional Commits

ä½¿ç”¨ [Conventional Commits](https://www.conventionalcommits.org/) è§„èŒƒã€‚

### æ ¼å¼

```
<type>(<scope>): <subject>

<body>

<footer>
```

### Type

- `feat`: æ–°åŠŸèƒ½
- `fix`: Bug ä¿®å¤
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
- `refactor`: é‡æ„
- `perf`: æ€§èƒ½ä¼˜åŒ–
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»º/å·¥å…·ç›¸å…³

### Examples

```bash
# æ–°åŠŸèƒ½
git commit -m "feat(session): add stream multiplexing support"

# Bug ä¿®å¤
git commit -m "fix(stream): resolve second request blocking issue"

# æ–‡æ¡£
git commit -m "docs: update README with v0.2.0 changes"

# é‡æ„
git commit -m "refactor(stream): separate reader and writer"

# æµ‹è¯•
git commit -m "test: add comprehensive integration tests"
```

### å¤šè¡Œæäº¤

```bash
git commit -m "feat(session): add stream multiplexing

This commit adds support for multiplexing multiple streams
over a single TLS connection.

Changes:
- Add Stream struct
- Implement frame routing
- Add stream lifecycle management

Closes #123"
```

---

## Pull Request æµç¨‹

### åˆ›å»º PR

1. **æ ‡é¢˜**: æ¸…æ™°æè¿°æ›´æ”¹
   ```
   feat: Add HTTP proxy support
   fix: Resolve memory leak in Stream
   docs: Update architecture documentation
   ```

2. **æè¿°**: ä½¿ç”¨æ¨¡æ¿

```markdown
## æè¿°

ç®€è¦æè¿°è¿™ä¸ª PR çš„ç›®çš„ã€‚

## æ›´æ”¹ç±»å‹

- [ ] Bug ä¿®å¤
- [ ] æ–°åŠŸèƒ½
- [ ] é‡æ„
- [ ] æ–‡æ¡£æ›´æ–°
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] æµ‹è¯•

## æ›´æ”¹å†…å®¹

- æ·»åŠ äº† X åŠŸèƒ½
- ä¿®å¤äº† Y é—®é¢˜
- é‡æ„äº† Z æ¨¡å—

## ç›¸å…³ Issue

Closes #123
Related to #456

## æµ‹è¯•

- [ ] å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] é›†æˆæµ‹è¯•é€šè¿‡
- [ ] æ‰‹åŠ¨æµ‹è¯•å®Œæˆ

## æ£€æŸ¥æ¸…å•

- [ ] ä»£ç éµå¾ªé¡¹ç›®é£æ ¼
- [ ] å·²æ·»åŠ æµ‹è¯•
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] å·²æ›´æ–°æ–‡æ¡£
- [ ] Clippy æ— è­¦å‘Š
- [ ] ä»£ç å·²æ ¼å¼åŒ–

## æˆªå›¾ï¼ˆå¦‚æœé€‚ç”¨ï¼‰

```

### PR å®¡æŸ¥

ç»´æŠ¤è€…ä¼šå®¡æŸ¥æ‚¨çš„ PRï¼Œå¯èƒ½ä¼šï¼š

- è¯·æ±‚æ›´æ”¹
- æå‡ºå»ºè®®
- åˆå¹¶ PR

### å®¡æŸ¥å

å¦‚æœéœ€è¦æ›´æ”¹ï¼š

```bash
# è¿›è¡Œæ›´æ”¹
git add .
git commit -m "fix: address review comments"
git push origin feature/your-feature
```

PR ä¼šè‡ªåŠ¨æ›´æ–°ã€‚

---

## å‘å¸ƒæµç¨‹

ï¼ˆä»…é™ç»´æŠ¤è€…ï¼‰

### 1. æ›´æ–°ç‰ˆæœ¬

```bash
# æ›´æ–° Cargo.toml
version = "0.3.0"

# æ›´æ–° CHANGELOG.md
## [0.3.0] - 2025-XX-XX
```

### 2. åˆ›å»ºæ ‡ç­¾

```bash
git tag -a v0.3.0 -m "Version 0.3.0: Description"
git push origin v0.3.0
```

### 3. å‘å¸ƒåˆ° crates.io

```bash
cargo publish
```

---

## è·å–å¸®åŠ©

### æ–‡æ¡£

- [README.md](README.md) - é¡¹ç›®æ¦‚è§ˆ
- [ARCHITECTURE.md](ARCHITECTURE.md) - æ¶æ„æ–‡æ¡£
- [TEST_GUIDE.md](TEST_GUIDE.md) - æµ‹è¯•æŒ‡å—

### ç¤¾åŒº

- [GitHub Discussions](https://github.com/yourusername/anytls-rs/discussions)
- [GitHub Issues](https://github.com/yourusername/anytls-rs/issues)

### è”ç³»

- Email: your-email@example.com

---

## è®¸å¯è¯

è´¡çŒ®å³è¡¨ç¤ºæ‚¨åŒæ„æ‚¨çš„ä»£ç å°†ä»¥ MIT è®¸å¯è¯å‘å¸ƒã€‚

---

**æ„Ÿè°¢æ‚¨çš„è´¡çŒ®ï¼** ğŸ‰

---

*æœ€åæ›´æ–°: 2025-11-03*

